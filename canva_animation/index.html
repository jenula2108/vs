<!DOCTYPE html>
<html lang="en">
<!-- &display=swap -->

<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="css/stile.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>js</title>
</head>

<body>
  <div class="wrapper">
    <header class="header"></header>
    <main id="#main" class="main__container">
      <h2>
        canvas
      </h2>
      <form action="">
        <input id="color" type="color">
        <input id="width" type="number">
      </form>
      <canvas class="canvas" id="cns" width="800px" height="400px">
      </canvas>
      <script>
        let canvas = document.getElementById('cns')
        let ctx = canvas.getContext('2d')
        let stapCount = 0
        let direction
        let x = 400
        let y = 200
        let arr = []
        let arr1 = []
        let len = 150
        function snake() {
          if (stapCount === 0) {
            stapCount = Math.floor(30 * Math.random())
            direction = Math.floor(4 * Math.random())
          }
          else {
            stapCount--
          }
          if (arr3[0]) {
            f2()

          }
          else {
            switch (direction) {
              case 0:
                y = y - 1
                break;
              case 1:
                x = x + 1
                break;
              case 2:
                y = y + 1
                break;
              case 3:
                x = x - 1
                break;
              // case 4:
              //   x=x+1
              //   y=y-1
              // break;
              // case 5:
              //   x=x+1
              //   y=y+1
              // break;
              // case 6:
              //   x=x-1
              //   y=y-1
              // break;
              // case 7:
              //   x=x-1
              //   y=y+1
              // break;
              default:
                break;
            }
          }
          arr1 = [x, y]
          arr.push([x, y])
          // console.log(arr1);
          // console.log(arr);
          ctx.fillRect(x - 3, y - 3, 6, 6)
          for (const el of arr) {
            if (el !== arr[arr.length - 1]) {
              if (JSON.stringify(el) === JSON.stringify(arr1)) {
                stapCount = 0
              }
            }
          }
          if (arr.length > len) {
            arr.shift()
            ctx.clearRect(arr[0][0] - 3, arr[0][1] - 3, 6, 6)
          }

          if (x < 0 || x > 800 || y < 0 || y > 400) stapCount = 0
        }
        setInterval(() => {
          snake()

        }, 50);
        let arr3 = []
        let x1
        let y1
        canvas.onclick = function (event) {
          x1 = event.offsetX
          y1 = event.offsetY
          ctx.fillRect(x1 - 3, y1 - 3, 6, 6)
          arr3.push([x1, y1])
        }
        function f2() {
          if (arr3[0][0] > x) x = x + 1
          if (arr3[0][1] > y) y = y + 1
          if (arr3[0][0] < x) x = x - 1
          if (arr3[0][1] < y) y = y - 1
          if (JSON.stringify(arr3[0]) === JSON.stringify(arr[arr.length - 1])) {
            arr3.shift()
            len = len + 10
            console.log(len);
            // ctx.clearRect(arr3[0][0]-3,arr3[0][1]-3,6,6)
          }
        }
      </script>
    </main>
    <footer class="footer">
    </footer>
  </div>
</body>

</html>
</script>
</main>
<footer class="footer">
  <div></div>
</footer>
</div>
</body>

</html>